<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>
<script>
    data = {
        const data = await d3.csv(await FileAttachment("traffic_weekly.csv").url(), ({name, date, total_1, total_2}) => ({name, date: new Date(date * 1000), value: +total_1 + +total_2}));
    return d3.nest()
        .key(d => d.name)
        .sortValues((a, b) => a.date - b.date)
        .entries(data)
        .map(d => (d.sum = d3.sum(d.values, d => d.value), d))
        .sort((a, b) => b.sum - a.sum);
    }
    area = d3.area()
        .curve(d3.curveBasis)
        .defined(d => !isNaN(d.value))
        .x(d => x(d.date))
        .y0(0)
        .y1(d => y(d.value))


</script>
</body>
</html>